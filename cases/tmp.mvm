baseunit dollar "$";
baseunit euro "ï¿½";
baseunit each "each";
baseunit bag "bag";
baseunit case "case";
baseunit can "can";
baseunit tub "tub";
baseunit gal "gal";
baseunit roll "roll";
baseunit sleeve "sleeve";
baseunit box "box";
baseunit bottle "bottle";
unit litre "l" (deci metre)^3;
unit pound "lb" 0.45359237*kilo gram;
unit ounce "oz" pound/16;
unit barrel "bbl" 117.347765*litre;
entity Product "case1/product.entity";
index Product bom_unit "case1/product.bom_unit";
index Product trade_unit "case1/product.trade_unit";
entity Commodity "case2/commodity.entity";
entity Year "case2/year.entity";
entity Region "case2/region.entity";
index Commodity unit "case2/commodity.unit";
entity Ingredient "case3/ingredient.entity";
entity Menu "case3/menu.entity";
index Ingredient unit "case3/ingredient.unit";
conversion conv "Product" "bom_unit" "trade_unit";
projection P0 "Commodity,Year,Region.1" "Commodity.1";
projection P1 "Commodity,Year,Region.1" "Commodity,Year.1";
projection P2 "Year,Commodity.1,unit" "Commodity,Year,Region.unit,1,1";
entity Place "case4/place.entity";
entity Transition "case4/transition.entity";
index Place unit "case4/place.unit";
load semi_bom "case3/semi_bom.csv" "1.0" "Ingredient.unit" "Menu.1.0";
load menu_sales "case3/menu_sales.csv" "1.0" "Menu.1.0" "empty";
load menu_price "case3/menu_price.csv" "dollar" "empty" "Menu.1.0";
load backward "case4/backward.csv" "1.0" "Place.unit" "Transition.1.0";
load stock2 "case3/stock2.csv" "1.0" "Ingredient.unit" "empty";
load stock1 "case3/stock1.csv" "1.0" "Ingredient.unit" "empty";
load ingredient_price "case3/ingredient_price.csv" "dollar" "empty" "Ingredient.unit";
load amount "case2/amount.csv" "1.0" "Commodity,Year,Region.unit,1.0,1.0" "empty";
load sales_price "case1/sales_price.csv" "dollar" "empty" "Product.trade_unit";
load sales "case2/sales.csv" "dollar" "empty" "Commodity,Year,Region.1.0";
load purchase_price "case1/purchase_price.csv" "dollar" "empty" "Product.trade_unit";
load forward "case4/forward.csv" "1.0" "Place.unit" "Transition.1.0";
load output "case1/output.csv" "1.0" "Product.trade_unit" "empty";
load bom "case1/bom.csv" "1.0" "Product.bom_unit" "Product.bom_unit";
eval r6 apply(iter, lambda (x) apply(single, x), apply(columns, apply(sum, backward, apply(negative, forward)))); 
print r6